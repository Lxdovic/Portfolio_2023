import e,{useState as t,useRef as r,useEffect as n,useMemo as o,useLayoutEffect as i}from"react";export{default as ReactFromModule}from"react";function c(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var u,a={exports:{}};(u=a).exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},u.exports.__esModule=!0,u.exports.default=u.exports;var s=c(a.exports),l={exports:{}},p={exports:{}};!function(e){e.exports=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o},e.exports.__esModule=!0,e.exports.default=e.exports}(p),function(e){var t=p.exports;e.exports=function(e,r){if(null==e)return{};var n,o,i=t(e,r);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(o=0;o<c.length;o++)n=c[o],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},e.exports.__esModule=!0,e.exports.default=e.exports}(l);var f=c(l.exports),b={exports:{}},v={exports:{}};!function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports}(v);var d={exports:{}};!function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],c=!0,u=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);c=!0);}catch(e){u=!0,o=e}finally{try{c||null==r.return||r.return()}finally{if(u)throw o}}return i}},e.exports.__esModule=!0,e.exports.default=e.exports}(d);var O={exports:{}},y={exports:{}};!function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports}(y),function(e){var t=y.exports;e.exports=function(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports}(O);var h={exports:{}};!function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}(h),function(e){var t=v.exports,r=d.exports,n=O.exports,o=h.exports;e.exports=function(e,i){return t(e)||r(e,i)||n(e,i)||o()},e.exports.__esModule=!0,e.exports.default=e.exports}(b);var x=c(b.exports),m=["type"],g=["children"];function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var P,S={thresholdCount:500,pauseAnimation:!0},E=e.createContext(S),_=e.createContext(void 0),I=function(e,t){var r=t.type,n=f(t,m);return"init"===r?w(w({},e),n):e},A=function(t){var r=t.children,n=f(t,g),o=Object.assign(S,n),i=e.useReducer(I,o),c=x(i,2),u=c[0],a=c[1];return e.createElement(E.Provider,{value:u},e.createElement(_.Provider,{value:a},r))};!function(e){e[e.None=0]="None",e[e.Initial=1]="Initial",e[e.Enter=2]="Enter",e[e.Leave=3]="Leave",e[e.Focus=4]="Focus"}(P||(P={}));var D=0,M=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!1},C=function(e){return Object.keys(e).filter((function(e){return!Number.isInteger(Number(e))}))},N=["itemState"];function R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?R(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var F=function(c){var u=c.element,a=c.index,s=c.onStateChange,l=r(P.None),p=r(null),b=r(null),v=[e.useContext(E),e.useContext(_)],d=x(v,1)[0],O=function(e){var o=t(null),i=x(o,2),c=i[0],u=i[1],a=r();return n((function(){var t=e.current;if(t){var r=new ResizeObserver((function(e){var t=x(e,1)[0].borderBoxSize[0],r=window.innerHeight,n=window.innerWidth,o=t.blockSize,i=t.inlineSize;u({height:Math.max(r,o),width:Math.max(n,i)})}));return r.observe(t),a.current=r,function(){r.disconnect()}}}),[]),[c]}(b),y=x(O,1)[0],h=function(e,o,i,c){var u=t(null),a=x(u,2),s=a[0],l=a[1],p=r();return n((function(){var t=o.current;if(t){var r=0,n=0,u={root:c,rootMargin:"0px",threshold:Array.from({length:i}).map((function(e,t){return(t+1)/i}))},a=new IntersectionObserver((function(t){var o,i,c=x(t,1)[0],u=c.intersectionRatio,a=c.boundingClientRect.y,s=c.isIntersecting;o=u>r&&s?"increase":"decrease",i=a>n&&s?"up":"down",r=u,n=a;var p={intersectRatio:u,isIntersecting:s,directionInterestRatio:o,directionScrollY:i};if(e){var f=e(p);f&&l(f)}else l(p)}),u);return a.observe(t),p.current=a,function(){a.disconnect(),p.current=void 0}}}),[i,c]),[s]}((function(e){return l.current<=P.None&&(e.directionInterestRatio=a%2==0?"decrease":"increase",e.directionScrollY="down"),e}),p,d.thresholdCount,d.rootElement),m=x(h,1)[0],g=function(e){setTimeout((function(){M("emit",a),s&&s(e,a,b.current),d.onStateChange&&d.onStateChange(e,a,b.current)}))},j=o((function(){if(!m||!y)return{};var e,t,r=[],n={},o=window.innerHeight,i=m.directionInterestRatio,c=m.directionScrollY,u=m.intersectRatio,a=m.isIntersecting,s=y.width,p=y.height,f=p*u,b=100*(1-f/o),v=l.current;(v=f>=2?a&&f>=o-2?P.Focus:P.Enter:P.Leave)===P.Enter?("down"===c?(e="increase"==i?"top":"bottom",t="increase"===i?"left":"right"):(e="decrease"==i?"top":"bottom",t="decrease"===i?"left":"right"),n[e]=0,n[t]="".concat(b,"%"),n.height="".concat(p,"px"),n.width="".concat(s,"px"),r.push("rhv-item-float")):r.push("rhv-item-absolute");return{className:r.join(" "),style:n,itemState:v}}),[y,m]),w=j.itemState,S=f(j,N);i((function(){if(w){l.current===P.None&&(M("Item",a,C(P)[P.Initial]),g(P.Initial)),M("Item",a,C(P)[w]),g(w);var e,t,r=b.current;r&&d.pauseAnimation&&(M("Animation",a,w!==P.Focus),e=r,t="pause-state",w!==P.Focus?e.hasAttribute(t)||e.setAttribute(t,""):e.hasAttribute(t)&&e.removeAttribute(t)),l.current=w}}),[w]);var I=o((function(){var e={},t=(null==y?void 0:y.height)||0;return t>0&&(e.height="".concat(t,"px")),{className:["rhv-item-wrapper"].join(" "),style:e}}),[y]);return e.createElement("div",k({ref:p},I),e.createElement("div",k({ref:b},S),u))};function z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var L=function(n){var i,c=n.children,u=t(),a=x(u,2),l=a[0],p=a[1],f=r((i=e.Children.count(c),Array.from({length:i}).map((function(){return!1})))),b=function(e,t){if(e===P.Initial){var r=f.current;r[t]=!0,p(r.every((function(e){return e})))}},v=o((function(){var t=e.Children.map(c,(function(t,r){var n={element:t,onStateChange:b,index:r};return e.createElement(F,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?z(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({key:"rhv-cnt-".concat(++D)},n))}));return t}),[c]);return e.createElement("div",{className:"rhv-container",style:{opacity:l?1:0}},v)},Y=["children"];function H(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var T=function(t){var r=t.children,n=f(t,Y);return e.createElement(A,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?H(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},n),e.createElement(L,null,r))};export{T as Rhv,L as RhvContainer,F as RhvItem,P as RhvItemState};
